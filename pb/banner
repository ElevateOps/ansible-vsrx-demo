---
- name: Create Junos Login Banner
  hosts: 127.0.0.1
  connection: local
  gather_facts: no
  vars:
    banner_file: files/banner
    banner_template: ../templates/login_message.conf  
  tasks:
    - name: loading banner content from file
      shell: flatcat {{ banner_file }}
      register: banner
    - name: creating banner Junos config
      template: src={{ banner_template }} dest=/var/tmp/banner.conf
      register: banner_conf
    - name: stop if no change
      fail: msg='banner has not changed'
      when: banner_conf.changed == False

- include: push_config config_file=/var/tmp/banner.conf






